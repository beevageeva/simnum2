ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc


      subroutine eigenval(a,x1,x2,x3)


      real*4     b,c
      real*4     a(3,3)
      real*4     adet,a2,a3,a212,tr
      real*4     x1,x2,x3


        a2d=a(1,1)**2.+a(2,2)**2.+a(3,3)**2.
        a2o=a(1,2)**2.+a(1,3)**2.+a(2,3)**2.
        a21=a(1,1)*a(3,3)+a(2,2)*a(3,3)+a(1,1)*a(2,2)
        a2=a21-(3.*a2o)-a2d

        adet=a(1,1)*a(2,2)*a(3,3)+2.*a(1,2)*a(1,3)*a(2,3)
        adet=adet-a(1,1)*a(2,3)*a(2,3)-a(2,2)*a(1,3)*a(1,3)
        adet=adet-a(3,3)*a(1,2)*a(1,2)

        tr=a(1,1)+a(2,2)+a(3,3)

        b=a2/9.
        
        c1=tr*(a21-a2o)
        c2=adet
        c3=tr*tr*tr

        c=((9.*c1)-(27.*c2)-(2*c3))/54.

C        c=-adet

        call cubic(b,c,x1,x2,x3)

       return
      end

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC


      subroutine cubic(b,c,x1,x2,x3)


c     Solving the cubic equation  x^3+ a x^2 +b x + c = 0, whereby all 
c     roots are real. The roots are ordered in descending order.


      double precision    twopi
      parameter           (twopi=6.283185307179586d0)

      real*4      b,c
      real*4      x1,x2,x3
 
      
        Q=b
        R=c

        Q3=Q*Q*Q
        R2=R*R
        Q12=sqrt(Q)

        if (R2.lt.Q3) then 
          if (R.gt.0.) then 
            theta=1.
          else
            theta=-1.
          endif
        else
          theta=(-1.*R)/sqrt(-1.*Q3)
          theta=acos(theta)
        endif


        phi=theta/3.
        x1=-2.*Q12*cos(phi)
        phi=(theta+twopi)/3.
        x2=-2.*Q12*cos(phi)
        phi=(theta-twopi)/3.
        x3=-2.*Q12*cos(phi)
