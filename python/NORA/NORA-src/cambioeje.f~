C************************************************************************
 
                SUBROUTINE cambioeje(gdev,eulert,euleri,istart,iend)

C************************************************************************
 
	IMPLICIT NONE
	INCLUDE 'nora.def'
        INTEGER n,l
C        REAL Rmax,zmod,coordmax,rmod
        INTEGER istart,iend
c        PARAMETER (Rmax=20)
        REAL eulert,euleri

        CHARACTER*(*) gdev
        REAL x2(nmax), y2(nmax), z2(nmax)

c-----------------------
c     cambio de coordenadas
c-----------------------
        

        do 30 l=istart,iend
           
           x2(l)=x(l)
           x(l)=0.
           y2(l)=y(l)
           y(l)=0.
           z2(l)=y(l)
           y(l)=0.

 30     CONTINUE

        eulert=eulert*3.141592654/180.
        euleri=euleri*3.141592654/180.

        do 40 n=istart,iend
           x(n)=x2(n)*cos(eulert) + y2(n)*sin(eulert)
           y(n)=z2(n)*sin(eulert)
           y(n)=y(n) + y2(n)*cos(eulert)*cos(euleri)
           y(n)=y(n) - x2(n)*cos(eulert)*sin(euleri)

           z(n)=z2(n)*cos(eulert)
           z(n)=z(n) + x2(n)*sin(eulert)*sin(euleri)
           z(n)=z(n) - y2(n)*sin(eulert)*cos(euleri)

 40     CONTINUE     

        RETURN
        END
      
